<script>
    const repoOwner = "banpobanpo";  // ë³¸ì¸ GitHub ID
    const repoName = "DailyNotice";  // JSON íŒŒì¼ì´ ìˆëŠ” ì €ì¥ì†Œ ì´ë¦„
    const filePath = "data.json";  // JSON íŒŒì¼ ê²½ë¡œ
    const accessToken = "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";  // GitHub Token

    async function updateData() {
        let updatedData = {};
        for (let i = 1; i <= 16; i++) {
            updatedData[`info${i}`] = document.getElementById(`info${i}`).value;
        }

        console.log("ğŸ”¹ ì—…ë°ì´íŠ¸í•  ë°ì´í„°:", updatedData); // ë””ë²„ê¹…

        // ê¸°ì¡´ JSON íŒŒì¼ì˜ SHA ê°’ ê°€ì ¸ì˜¤ê¸°
        const getFile = await fetch(`https://api.github.com/repos/${repoOwner}/${repoName}/contents/${filePath}`, {
            headers: { "Authorization": `token ${accessToken}` }
        });

        if (!getFile.ok) {
            console.error("âŒ íŒŒì¼ì„ ê°€ì ¸ì˜¤ëŠ” ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.", await getFile.text());
            alert("íŒŒì¼ì„ ê°€ì ¸ì˜¤ëŠ” ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. GitHub Token ë° Repository ì„¤ì •ì„ í™•ì¸í•˜ì„¸ìš”.");
            return;
        }

        const fileData = await getFile.json();
        const sha = fileData.sha;
        console.log("ğŸ”¹ í˜„ì¬ SHA ê°’:", sha);

        const updatePayload = {
            message: "Update data.json",
            content: btoa(JSON.stringify(updatedData, null, 2)),  // Base64 ì¸ì½”ë”©
            sha: sha
        };

        const response = await fetch(`https://api.github.com/repos/${repoOwner}/${repoName}/contents/${filePath}`, {
            method: "PUT",
            headers: {
                "Authorization": `token ${accessToken}`,
                "Content-Type": "application/json"
            },
            body: JSON.stringify(updatePayload)
        });

        const responseData = await response.json();
        console.log("ğŸ”¹ GitHub ì‘ë‹µ:", responseData); // ë””ë²„ê¹…

        if (response.ok) {
            alert("âœ… ë°ì´í„°ê°€ ì„±ê³µì ìœ¼ë¡œ ì—…ë°ì´íŠ¸ë˜ì—ˆìŠµë‹ˆë‹¤.");
            loadData();
        } else {
            console.error("âŒ ì—…ë°ì´íŠ¸ ì‹¤íŒ¨:", responseData);
            alert("ì—…ë°ì´íŠ¸ ì‹¤íŒ¨: " + responseData.message);
        }
    }
</script>
